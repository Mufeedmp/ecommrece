<!DOCTYPE html>
<html lang="zxx">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Male_Fashion Template" />
    <meta name="keywords" content="Male_Fashion, unica, creative, html" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Gents Club </title>

    <!-- Google Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="/css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="/css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="/css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="/css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="/css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
   
    
   
   
</head>
<body>


<%- include("../../views/partials/user/header") %>

<div class="content-wrapper">
    <div class="container py-5">
        <h1 class="text-center mb-4">Manage Offers</h1>

        <!-- Product Offer List -->
        <h3>Product Offers</h3>
        <div class="offer-list">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Offer Percentage</th>
                        <th>Offer Expiry</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dynamically generated rows for product offers will go here -->
                    <tr>
                        <td>Sample Product</td>
                        <td>10%</td>
                        <td>2025-01-31</td>
                        <td>
                            <a href="/admin/offers/edit/" class="btn btn-warning btn-sm">Edit</a>
                            <button class="btn btn-danger btn-sm" onclick="deleteOffer('123')">Delete</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Add New Product Offer Button -->
        <div class="text-end mb-4">
            <a href="/admin/offers/add" class="btn btn-primary">Add New Product Offer</a>
        </div>

        <!-- Category Offer List -->
        <h3>Category Offers</h3>
        <div class="category-offer-list">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Offer Percentage</th>
                        <th>Offer Expiry</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Dynamically generated rows for category offers will go here -->
                    <tr>
                        <td>Electronics</td>
                        <td>15%</td>
                        <td>2025-02-15</td>
                        <td>
                            <a href="/admin/offers/edit/category" class="btn btn-warning btn-sm">Edit</a>
                            <button class="btn btn-danger btn-sm" onclick="deleteCategoryOffer('456')">Delete</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Add New Category Offer Button -->
        <div class="text-end mb-4">
            <a href="/admin/offers/add/category" class="btn btn-primary">Add New Category Offer</a>
        </div>
    </div>
</div>

    <!-- Footer -->
    <%- include("../../views/partials/user/footer") %>
    
    
    <!-- Search Begin -->
    <div class="search-model">
      <div class="h-100 d-flex align-items-center justify-content-center">
          <div class="search-close-switch">+</div>
          <form class="search-model-form">
              <input type="text" id="search-input" placeholder="Search here.....">
          </form>
      </div>
    </div>
    <!-- Search End -->
    
    <!-- Js Plugins -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/jquery.nice-select.min.js"></script>
    <script src="/js/jquery.nicescroll.min.js"></script>
    <script src="/js/jquery.magnific-popup.min.js"></script>
    <script src="/js/jquery.countdown.min.js"></script>
    <script src="/js/jquery.slicknav.js"></script>
    <script src="/js/mixitup.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </body>
  </html>
  
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        async function deleteOffer(offerId) {
            try {
                const response = await fetch(`/admin/offers/delete/${offerId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const data = await response.json();

                if (response.ok) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Offer deleted successfully!',
                        text: data.message,
                        confirmButtonText: 'OK',
                    });
                    location.reload(); // Refresh the page after deletion
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: data.message || 'Something went wrong!',
                    });
                }
            } catch (error) {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to delete offer!',
                });
            }
        }
        async function deleteCategoryOffer(categoryId) {
        try {
            const response = await fetch(`/admin/offers/delete/category/${categoryId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                }
            });

            const data = await response.json();

            if (response.ok) {
                Swal.fire({
                    icon: 'success',
                    title: 'Category offer deleted successfully!',
                    text: data.message,
                    confirmButtonText: 'OK',
                });
                location.reload(); // Refresh the page after deletion
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: data.message || 'Something went wrong!',
                });
            }
        } catch (error) {
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Failed to delete category offer!',
            });
        }
    }
    </script>

</body>
</html>
